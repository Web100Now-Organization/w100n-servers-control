# Security Check Script - Documentation

## –û–ø–∏—Å

`security-check.sh` - —Ü–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±–µ–∑–ø–µ–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞, –≤–∏–¥–∞–ª–µ–Ω–Ω—è –º–∞–ª–≤–µ—Ä—É —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ email —Å–ø–æ–≤—ñ—â–µ–Ω—å –ø—Ä–æ –∫—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏.

## –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –º–∞–ª–≤–µ—Ä—É:
- ‚úÖ –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–∏—Ö systemd —Å–µ—Ä–≤—ñ—Å—ñ–≤
- ‚úÖ –í–±–∏–≤—Å—Ç–≤–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤
- ‚úÖ –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ —Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π
- ‚úÖ –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏—Ö –ø–æ—Ä—Ç—ñ–≤ —á–µ—Ä–µ–∑ UFW

### –ö–æ–º–ø–ª–µ–∫—Å–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:
1. SSH –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
2. –°—Ç–∞—Ç—É—Å —Ñ–∞–π—Ä–≤–æ–ª—É (UFW)
3. –í—ñ–¥–∫—Ä–∏—Ç—ñ –ø–æ—Ä—Ç–∏ (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ)
4. –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –º–∞–ª–≤–µ—Ä—É (–ø—Ä–æ—Ü–µ—Å–∏, —Ñ–∞–π–ª–∏, rootkit)
5. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ cron jobs
6. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ systemd —Å–µ—Ä–≤—ñ—Å—ñ–≤
7. –ë–µ–∑–ø–µ–∫–∞ Docker
8. –ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏
9. –ù–µ–≤–¥–∞–ª—ñ —Å–ø—Ä–æ–±–∏ –≤—Ö–æ–¥—É
10. –°—Ç–∞—Ç—É—Å Fail2ban
11. –î–æ—Å—Ç—É–ø–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
12. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–∏—Å–∫—É
13. –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è ClamAV
14. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ rootkit (rkhunter, chkrootkit)
15. –ü—ñ–¥–æ–∑—Ä—ñ–ª—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è
16. –¶—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
17. –°—Ç–∞–Ω Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤

### Email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è:
- üìß –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ email –ø—Ä–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—ñ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º
- üìß –î–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç –ø—Ä–æ –≤–∏—è–≤–ª–µ–Ω—ñ –∑–∞–≥—Ä–æ–∑–∏
- üìß –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –≤–∏–¥–∞–ª–µ–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏, –ø—Ä–æ—Ü–µ—Å–∏ —Ç–∞ —Ñ–∞–π–ª–∏

## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### 1. –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Email

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –≤ `security-check.sh`:

```bash
GMAIL_SENDER_EMAIL="notification@web100now.com"
GMAIL_APP_PASSWORD="xymr gnxf grvv dqzv"
LOG_REPORT_RECIPIENT="maksym_tymoshenko@web100now.com"
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Python3 (–¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ email)
apt install python3 -y

# –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –±–µ–∑–ø–µ–∫–∏
apt install clamav rkhunter chkrootkit -y
freshclam  # –û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–∑–∏ ClamAV
rkhunter --update  # –û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–∑–∏ rkhunter
```

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –†—É—á–Ω–∏–π –∑–∞–ø—É—Å–∫:

```bash
# –ó—Ä–æ–±–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–º
chmod +x security-check.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É
./security-check.sh
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ (–∫–æ–∂–Ω—É –≥–æ–¥–∏–Ω—É):

```bash
# –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ cron job
chmod +x setup-security-cron.sh
./setup-security-cron.sh
```

–ê–±–æ –≤—Ä—É—á–Ω—É:

```bash
# –î–æ–¥–∞—Ç–∏ cron job
(crontab -l 2>/dev/null; echo "0 * * * * /path/to/security-check.sh >> /var/log/security-check-cron.log 2>&1") | crontab -

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ cron jobs
crontab -l
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–≤—ñ—Ç—ñ–≤

### –§–∞–π–ª–∏ –∑–≤—ñ—Ç—ñ–≤:
- `/root/security-reports/security-audit-YYYYMMDD_HHMMSS.log` - –ø–æ–≤–Ω–∏–π –∑–≤—ñ—Ç
- `/var/log/security-check-cron.log` - –ª–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ö –∑–∞–ø—É—Å–∫—ñ–≤

### –§–æ—Ä–º–∞—Ç email —Å–ø–æ–≤—ñ—â–µ–Ω—å:

Email –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—ñ **–∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º**:
- –í–∏—è–≤–ª–µ–Ω—ñ –º–∞–ª–≤–µ—Ä –ø—Ä–æ—Ü–µ—Å–∏
- –í–∏—è–≤–ª–µ–Ω—ñ –∑–ª–æ–≤–º–∏—Å–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏
- –í–∏—è–≤–ª–µ–Ω—ñ –∑–ª–æ–≤–º–∏—Å–Ω—ñ —Ñ–∞–π–ª–∏
- Rootkit –¥–µ—Ç–µ–∫—Ç–æ–≤–∞–Ω–æ
- –ë–∞–∑–∏ –¥–∞–Ω–∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ñ –∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É
- –ü—ñ–¥–æ–∑—Ä—ñ–ª—ñ –ø–æ—Ä—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ

## –¢–∏–ø–∏ –º–∞–ª–≤–µ—Ä—É, —â–æ –≤–∏—è–≤–ª—è—é—Ç—å—Å—è

### –ü—Ä–æ—Ü–µ—Å–∏:
- xmrig, miner, kinsing
- systemhelper, linuxsys, wsystemd
- Gqr7dweg, 1z1Mv3GA, B7mQL, lrt
- bot, kdevtmpfsi, watchbog, ddgs
- qW3xT, 2t3ik, kinsingd
- libsystem, libapache, libnetwork
- –ü—ñ–¥–æ–∑—Ä—ñ–ª—ñ Go —Å–µ—Ä–≤–µ—Ä–∏ –≤ /tmp

### –§–∞–π–ª–∏ —Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó:
- /etc/data/kinsing
- /usr/local/bin/systemhelper
- /usr/sbin/wsystemd
- /dev/*.sh, /dev/x86, /dev/x64
- /tmp/go-build* (–ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ Go —Å–µ—Ä–≤–µ—Ä–∏)
- –§–∞–π–ª–∏ –º–∞–π–Ω–µ—Ä—ñ–≤ –≤ /tmp, /var/tmp, /dev/shm

### –°–µ—Ä–≤—ñ—Å–∏:
- bot.service
- kinsing —Å–µ—Ä–≤—ñ—Å–∏
- system-daemon, system-sysinit, system-syslog

### –ü–æ—Ä—Ç–∏:
- 21100-21110 (Docker API)
- 8082 (–ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ Go —Å–µ—Ä–≤–µ—Ä–∏)
- 3333, 4444, 5555, 7777 (–º–∞–π–Ω—ñ–Ω–≥ –ø—É–ª–∏)

## –û—Ü—ñ–Ω–∫–∞ –±–µ–∑–ø–µ–∫–∏

–°–∫—Ä–∏–ø—Ç –Ω–∞–¥–∞—î –æ—Ü—ñ–Ω–∫—É –±–µ–∑–ø–µ–∫–∏ –≤—ñ–¥ 0 –¥–æ 100:

- **95-100**: –í—ñ–¥–º—ñ–Ω–Ω–æ - —Å–µ—Ä–≤–µ—Ä –¥–æ–±—Ä–µ –∑–∞—Ö–∏—â–µ–Ω–∏–π
- **85-94**: –î—É–∂–µ –¥–æ–±—Ä–µ - —Å–µ—Ä–≤–µ—Ä –∑–∞—Ö–∏—â–µ–Ω–∏–π
- **70-84**: –î–æ–±—Ä–µ - —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç—å—Å—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è
- **50-69**: –ü–æ—Ç—Ä–µ–±—É—î –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è - –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥—ñ—ó
- **30-49**: –ü–æ–≥–∞–Ω–æ - —Å–µ—Ä–≤–µ—Ä –≤—Ä–∞–∑–ª–∏–≤–∏–π
- **0-29**: –ö—Ä–∏—Ç–∏—á–Ω–æ - —Å–µ—Ä–≤–µ—Ä —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π

## –£—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Email –Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è:

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å Python3:
```bash
python3 --version
```

2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å Gmail App Password:
   - –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –ø–∞—Ä–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π (–±–µ–∑ –ø—Ä–æ–±—ñ–ª—ñ–≤)
   - –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ 2FA —É–≤—ñ–º–∫–Ω–µ–Ω–æ –≤ Gmail

3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ SMTP:
```bash
telnet smtp.gmail.com 587
```

### Cron job –Ω–µ –ø—Ä–∞—Ü—é—î:

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏:
```bash
tail -f /var/log/security-check-cron.log
```

2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É:
```bash
chmod +x /path/to/security-check.sh
```

3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ cron:
```bash
systemctl status cron
```

## –ë–µ–∑–ø–µ–∫–∞

‚ö†Ô∏è **–í–ê–ñ–õ–ò–í–û:**
- –°–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –º–∞–ª–≤–µ—Ä—É
- –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä –ø—ñ—Å–ª—è –æ—á–∏—â–µ–Ω–Ω—è
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –ª–æ–≥–∏ —Ç–∞ email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
- –ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞—Ö

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–ü—Ä–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏: `/root/security-reports/`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ñ –ª–æ–≥–∏: `journalctl -xe`

## –í–µ—Ä—Å—ñ—è

**Version 3.0** - –∑ email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è–º–∏ —Ç–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–º–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞–º–∏

